dir()
?SFastqQuality
library("ShortRead")
?SFastqQuality
?append
x <- DNAString("AAGCGCGATATG")m1 <- matchPattern("GCNNNAT", x)
x <- DNAString("AAGCGCGATATG")
m1 <- matchPattern("GCNNNAT", x)
m1
m1 <- matchPattern("GCNNNAT", x, fixed=FALSE)
m1
?nedit
TCGTATGCCGTCTTCTGCTTGTT
nchar("TCGTATGCCGTCTTCTGCTTGTT")
adapter <- "TCGTATGCCGTCTTCTGCTTGTT"
adapterPad <- paste(substr(adapter,1,12), paste(rep("N", 25),collapse=""), sep="")
adapterPad
nchar(adapterPad)
proba<-DNAStrinSet("TCGTATGCCGTCNNNNNNNNNNNNNNNNNNNNNNNNN")
proba<-DNAStringSet("TCGTATGCCGTCNNNNNNNNNNNNNNNNNNNNNNNNN")
proba<-DNAStringSet("TCGTATGCCGTCNNNNNNNNNNNNNNNNNNNNNNNNN,")
adapter<-"ACGTACGT"
proba<-DNAStringSet("ACGTACGTAAAAAAAA",
"AAAAACGTACGTAAAA"
"AAAAAAAAACGTACGT"
"AAAAAAAAACGTACGT"
)
adapter<-"ACGTACGT"
proba<-DNAStringSet("ACGTACGTAAAAAAAA",
"AAAAACGTACGTAAAA",
"AAAAAAAAACGTACGT",
"AAAAAAAAACGTACGT")
proba<-DNAStringSet("ACGTACGTAAAAAAAA")
proba
adapter<-"ACGTACGT"
adapterPad<-"ACGTACGTNNNNNNNN"
maxMmPad<-c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
proba<-DNAStringSet("AACGTACGTAAAAAAA")
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
proba<-DNAStringSet("AAAAACGTACGTAAAA")
,
proba<-DNAStringSet("AAAAACGTACGTAAAA")
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
proba<-DNAStringSet("AAAACCGTACGTAAAA")
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
maxMmPad<-c(1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
maxMmPad<-c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
maxMmPad<-c(1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1)
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
maxMmPad<-c(1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
maxMmPad<-c(1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
proba
maxMmPad<-c(2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
maxMmPad<-c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
proba<-DNAStringSet("AAAACCGTACGTAAAA")
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
proba<-DNAStringSet("AAAACGGTACGTAAAA")
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
maxMmPad<-c(1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2)
proba<-DNAStringSet("AAAACGGTACGTAAAA")
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
maxMmPad<-c(1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2)
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
maxMmPad<-c(0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2)
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
proba<-DNAStringSet("AAAAGGGGacgtacgt")
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
proba<-DNAStringSet("AAAAGGGGacgtac")
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
proba<-DNAStringSet("AAAAGGGGacgta")
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
proba<-DNAStringSet("AAAAGGGGacgtt")
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
proba<-DNAStringSet("AAAAGGGGacgat")
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
proba<-DNAStringSet("AAAAGGGGacaat")
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
maxMmPad<-c(0,0,3,3,3,3,3,3,3,3,3,3,3,3,3,3)
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
maxMmPad<-c(0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2)
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
proba<-DNAStringSet("AAAAGGGGacaat")
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
maxMmPad<-c(0,0,1,1,2,2,2,2,2,2,2,2,2,2,2,2)
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
proba<-DNAStringSet("AAAAGGGGac")
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
proba<-DNAStringSet("AAAAGGGGag")
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
maxMmPad<-c(0,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2)
trimLRPatterns(Rpattern=adapterPad, subject=proba, max.Rmismatch=maxMmPad, ranges=TRUE, with.Rindels=FALSE, Rfixed=FALSE)
paste(rep("N", 25),collapse="")
paste(rep("N", 25),collapse="f")
paste(rep("N", 25))
?writeFastQ
?writeFastq
install.packages(c("boot", "class", "cluster", "devtools", "evaluate", "foreign", "httr", "KernSmooth", "lattice", "MASS", "Matrix", "mgcv", "nlme", "nnet", "Rcpp", "rpart", "spatial"))
source("http://bioconductor.org/biocLite.R")
biocLite("ShortRead")
?writeFastq
library("ShortRead")
?writeFastq
library("ShortRead")
library("rtracklayer")
library("Rsamtools")
library("IRanges")
?scanBamFlag
?readGAlignmentsFromBam
install.packages("MASS")
source("http://bioconductor.org/biocLite.R")
biocLite()
source("http://bioconductor.org/biocLite.R")
biocLite("Rsamtools")
source('~/Desktop/R/R.programs/BigWig.normalize.R')
?mcols
library("Biobase")
load("~/Desktop/R/annotation/S.pombe.EF2/EF2.mRNA.Rdat")
gene.gr<-ann.gr
load("N.genemed50.RNAseq.Sp.wt.210214.mRNA.profileS.Rdat")
load("~/Desktop/R/annotation/S.pombe.EF2/EF2.introns1to854.Rdat")
intron.gr<-ann.gr
rm(ann.gr)
load("~/Desktop/R/annotation/S.pombe.EF2/EF2.introns1to854.Rdat")
intron.gr<-ann.gr
rm(ann.gr)
load("~/Documents/seq_data/seq_019_RNAseq_SpPE90_red1d_red3d_rrp6d_rip2d_nrl1d_WT_mmi1d/BigWig_files/N.genemed50/N.genemed50.RNAseq.Sp.wt.210214.mRNA.profileS.Rdat")
gene.med<-rowMedians(profile.rle)
setwd("~/Desktop/R/annotation/S.pombe.EF2/filters")
load("~/Desktop/R/annotation/S.pombe.EF2/EF2.introns1to854.Rdat")
load("~/Desktop/R/annotation/S.pombe.EF2/filters/EF2.introns1to854.median.mRNA.N.genemed50.wt210214.Rdat")
gr.filter<-intron.mRNA.med>=20     # median expression >= 20     - 4026 introns (out of 5217 introns)
save(gr.filter,file="filt.EF2.introns1to854.medianexpr.min20.filter")
setwd("~/Desktop/R/annotation/S.pombe.EF2/filters")
load("~/Desktop/R/annotation/S.pombe.EF2/EF2.introns1to854.Rdat")
hist(width(ann.gr),breaks=1000,xlim=c(0,200))
gr.filter<-width(ann.gr)<=50    # introns smaller or equal than 50 bp - 2116 introns (out of 5217 introns)
save(gr.filter,file="filt.EF2.introns1to854.max50.filter")
gr.filter<-width(ann.gr)>50    # introns larger than 50 bp - 3101 introns (out of 5217 introns)
save(gr.filter,file="filt.EF2.introns1to854.min51.filter")
setwd("~/Desktop/R/annotation/S.pombe.EF2/filters")
load("~/Desktop/R/annotation/S.pombe.EF2/EF2.mRNA.Rdat")
setwd("~/Desktop/R/annotation/S.pombe.EF2/filters")
load("~/Desktop/R/annotation/S.pombe.EF2/EF2.mRNA.Rdat")
head(ann.gr)
seqnames(ann.gr)[1:10]
gr.filter<- seqnames(ann.gr)!="I"
gr.filter[1:10]
gr.filter<- seqnames(ann.gr)=="aaaa"  # everything false
gr.filter[1:10]
gr.filter<-gr.filter | (seqnames(ann.gr)=="II")
gr.filter[1:10]
?GRanges
source('~/Desktop/R/Rprograms_for_microarrays/BedGraph_converter/func.wigend.mod.R')
setwd("~/Documents/Microarray data/sp40c/253622710021_201303281543/second scan/ChIP/253622710021_wig files/log2 ratio")
dir()
wigend.modifier("H3K9me dhp1 ts.chip.wig",f.mod=0,f.M12=TRUE)
wigend.modifier("H3K9me din1d.chip.wig",f.mod=0,f.M12=TRUE)
setwd("~/Documents/Microarray data/sp40c/253622710005_201205031820/wig_files")
aaa<-dir()
aaa
wigend.modifier(aaa[1],f.mod=0,f.M12=TRUE)
wigend.modifier(aaa[2],f.mod=0,f.M12=TRUE)
wigend.modifier(aaa[3],f.mod=0,f.M12=TRUE)
wigend.modifier(aaa[4],f.mod=0,f.M12=TRUE)
setwd("~/Documents/Microarray data/sp40c/253622710006_201205081526/wig files")
aaa<-dir()
wigend.modifier(aaa[1],f.mod=0,f.M12=TRUE)
wigend.modifier(aaa[2],f.mod=0,f.M12=TRUE)
wigend.modifier(aaa[3],f.mod=0,f.M12=TRUE)
wigend.modifier(aaa[4],f.mod=0,f.M12=TRUE)
df <- data.frame(chr="II", start=74000, end=1597500,
strand=("*"), score=1)
df
?rbind
df<- rbind(df,data.frame(chr="II", start=1650000, end=2113800,strand=("*"), score=1)) # chr2 right arm from cnt to mat locus (no centr, no mat locus)
df
df<- rbind(df,data.frame(chr="II", start=2138000, end=4463000,strand=("*"), score=1)) # chr2 right arm from cnt to mat locus (no centr, no mat locus)
df
df<- rbind(df,data.frame(chr="III", start=30000, end=1064500,strand=("*"), score=1)) # chr2 right arm from cnt to mat locus (no centr, no mat locus)
df
df<- rbind(df,data.frame(chr="III", start=1145000, end=1323000,strand=("*"), score=1)) # chr2 right arm from cnt to mat locus (no centr, no mat locus)
df
filt.GRanges<-makeGRangesFromDataFrame(df)
filt.Granges
filt.GRanges
ann.gr
filt.GR<-makeGRangesFromDataFrame(df)
seqlength(fil.GR)<-seqlength(ann.gr)
seqlengths(fil.GR)<-seqlengths(ann.gr)
seqlengths(filt.GR)<-seqlengths(ann.gr)
seqinfo(ann.gr)
filt.GR<-makeGRangesFromDataFrame(df,seqinfo=seqinfo(ann.gr))
filt.GR
aaa<-findOverlaps(ann.gr,filt.GR)
aaa
aaa<-overlapsAny(ann.gr,filt.GR)
aaa
ann.gr
ann.grsum(aaa)
sum(aaa)
aaa[1:10]
ann.gr[1:10]
df <- data.frame(chr="II", start=74000, end=1597500,strand=("*"), score=1)  # chr2 left arm no telomer, no centromer
df<- rbind(df,data.frame(chr="II", start=1650000, end=2113800,strand=("*"), score=1)) # chr2 right arm from cnt to mat locus (no centr, no mat locus)
df<- rbind(df,data.frame(chr="II", start=2138000, end=4484000,strand=("*"), score=1)) # chr2 right arm from mat to tel (no mat, no tel)
df<- rbind(df,data.frame(chr="III", start=30000, end=1064500,strand=("*"), score=1)) # chr3 left arm from tel to cen(no tel, no cen)
df<- rbind(df,data.frame(chr="III", start=1145000, end=1323000,strand=("*"), score=1)) # chr3 right arm from cnt to end of high resolution of Sp40c (no centr, no low res)
filt.GR<-makeGRangesFromDataFrame(df,seqinfo=seqinfo(ann.gr))
aaa<-overlapsAny(ann.gr,filt.GR)
ann.gr[1:10]
aaa[1:10]
sum(aaa)
gr.filter<-overlapsAny(ann.gr,filt.GR, type="within")
sum(gr.filter)
ann.gr[aaa=!gr.filter]
ann.gr([aaa=!gr.filter)]
ann.gr[(aaa=!gr.filter)]
ann.gr[(aaa!=gr.filter)]
ann.gr[(aaa)]
bbb<-aaa != gr.filter
bbb[1:10]
aaa
aaa[1:10]
gr.filet[1:10]
gr.filter[1:10]
gr.filter<-overlapsAny(ann.gr,filt.GR, type="within")
gr.filter[1:10]
ann.gr[1:10]
aaa<-overlapsAny(ann.gr,filt.GR, type="any")
sum(aaa)
sum(gr.filter)
bbb<-aaa!=gr.filter
sum(bbb)
ann.gr[bbb]
df <- data.frame(chr="II", start=74000, end=1597500,strand=("*"), score=1)  # chr2 left arm no telomer, no centromer
df<- rbind(df,data.frame(chr="II", start=1650000, end=2113800,strand=("*"), score=1)) # chr2 right arm from cnt to mat locus (no centr, no mat locus)
df<- rbind(df,data.frame(chr="II", start=2138000, end=4484000,strand=("*"), score=1)) # chr2 right arm from mat to tel (no mat, no tel)
df<- rbind(df,data.frame(chr="III", start=30000, end=1064500,strand=("*"), score=1)) # chr3 left arm from tel to cen(no tel, no cen)
df<- rbind(df,data.frame(chr="III", start=1144800, end=1323000,strand=("*"), score=1)) # chr3 right arm from cnt to end of high resolution of Sp40c (no centr, no low res)
filt.GR<-makeGRangesFromDataFrame(df,seqinfo=seqinfo(ann.gr))
gr.filter<-overlapsAny(ann.gr,filt.GR, type="within")
bbb<-aaa!=gr.filter
ann.gr[bbb]
setwd("~/Desktop/R/annotation/S.pombe.EF2/filters")
setwd("~/Desktop/R/annotation/S.pombe.EF2/filters")
load("~/Desktop/R/annotation/S.pombe.EF2/EF2.mRNA.Rdat")
##### all mRNA, high resolution, no heterochromatin (2321 genes)  HiRes.mRNA.NoHetChr.trim
df <- data.frame(chr="II", start=74000, end=1597500,strand=("*"), score=1)  # chr2 left arm no telomer, no centromer
df<- rbind(df,data.frame(chr="II", start=1650000, end=2113800,strand=("*"), score=1)) # chr2 right arm from cnt to mat locus (no centr, no mat locus)
df<- rbind(df,data.frame(chr="II", start=2138000, end=4484000,strand=("*"), score=1)) # chr2 right arm from mat to tel (no mat, no tel)
df<- rbind(df,data.frame(chr="III", start=30000, end=1064500,strand=("*"), score=1)) # chr3 left arm from tel to cen(no tel, no cen)
df<- rbind(df,data.frame(chr="III", start=1144800, end=1323000,strand=("*"), score=1)) # chr3 right arm from cnt to end of high resolution of Sp40c (no centr, no low res)
filt.GR<-makeGRangesFromDataFrame(df,seqinfo=seqinfo(ann.gr))
gr.filter<-overlapsAny(ann.gr,filt.GR, type="within")
save(gr.filter, file="EF2.mRNA.sp40cHiRes.NoHetChr.filter")
setwd("~/Desktop/R/annotation/S.pombe.2007/filters")
load("~/Desktop/R/annotation/S.pombe.2007/sp07.mRNA.Rdat")
##### all mRNA, high resolution, no heterochromatin (2321 genes)  HiRes.mRNA.NoHetChr.trim
df <- data.frame(chr="II", start=74000, end=1597500,strand=("*"), score=1)  # chr2 left arm no telomer, no centromer
df<- rbind(df,data.frame(chr="II", start=1650000, end=2113800,strand=("*"), score=1)) # chr2 right arm from cnt to mat locus (no centr, no mat locus)
df<- rbind(df,data.frame(chr="II", start=2138000, end=4484000,strand=("*"), score=1)) # chr2 right arm from mat to tel (no mat, no tel)
df<- rbind(df,data.frame(chr="III", start=30000, end=1064500,strand=("*"), score=1)) # chr3 left arm from tel to cen(no tel, no cen)
df<- rbind(df,data.frame(chr="III", start=1144800, end=1323000,strand=("*"), score=1)) # chr3 right arm from cnt to end of high resolution of Sp40c (no centr, no low res)
filt.GR<-makeGRangesFromDataFrame(df,seqinfo=seqinfo(ann.gr))
gr.filter<-overlapsAny(ann.gr,filt.GR, type="within")
sum(gr.filter)
save(gr.filter, file="sp07.mRNA.sp40cHiRes.NoHetChr.filter")
setwd("~/Desktop/R/annotation/S.pombe.EF2/filters")
load("~/Desktop/R/annotation/S.pombe.EF2/EF2.mRNA.Rdat")
df <- data.frame(chr="I", start=50000, end=739000,strand=("*"), score=1)  # chr1 left arm no telomer, until ura (no tel, no ura)
df<- rbind(df,data.frame(chr="I", start=746400, end=3752000,strand=("*"), score=1)) # chr1 left arm from ura to cen (no ura, no cen)
df<- rbind(df,data.frame(chr="I", start=3799000, end=5495200,strand=("*"), score=1)) # chr1 right arm from cen to tel (no cen, no tel)
df<- rbind(df,data.frame(chr="II", start=74000, end=1597500,strand=("*"), score=1)) # chr2 left arm no telomer, no centromer
df<- rbind(df,data.frame(chr="II", start=1650000, end=2113800,strand=("*"), score=1)) # chr2 right arm from cnt to mat locus (no centr, no mat locus)
df<- rbind(df,data.frame(chr="II", start=2138000, end=4484000,strand=("*"), score=1)) # chr2 right arm from mat to tel (no mat, no tel)
df<- rbind(df,data.frame(chr="III", start=30000, end=1064500,strand=("*"), score=1)) # chr3 left arm from tel to cen(no tel, no cen)
df<- rbind(df,data.frame(chr="III", start=1144800, end=2438000,strand=("*"), score=1)) # chr3 right arm from cnt to tel (no centr, no tel)
filt.GR<-makeGRangesFromDataFrame(df,seqinfo=seqinfo(ann.gr))
filt.GR
gr.filter<-overlapsAny(ann.gr,filt.GR, type="within")
sum(gr.filter)
ann.gr
save(gr.filter, file="EF2.mRNA.NoHetChr.filter")
setwd("~/Desktop/R/annotation/S.pombe.2007/filters")
load("~/Desktop/R/annotation/S.pombe.2007/sp07.mRNA.Rdat")
df <- data.frame(chr="I", start=50000, end=739000,strand=("*"), score=1)  # chr1 left arm no telomer, until ura (no tel, no ura)
df<- rbind(df,data.frame(chr="I", start=746400, end=3752000,strand=("*"), score=1)) # chr1 left arm from ura to cen (no ura, no cen)
df<- rbind(df,data.frame(chr="I", start=3799000, end=5495200,strand=("*"), score=1)) # chr1 right arm from cen to tel (no cen, no tel)
df<- rbind(df,data.frame(chr="II", start=74000, end=1597500,strand=("*"), score=1)) # chr2 left arm no telomer, no centromer
df<- rbind(df,data.frame(chr="II", start=1650000, end=2113800,strand=("*"), score=1)) # chr2 right arm from cnt to mat locus (no centr, no mat locus)
df<- rbind(df,data.frame(chr="II", start=2138000, end=4484000,strand=("*"), score=1)) # chr2 right arm from mat to tel (no mat, no tel)
df<- rbind(df,data.frame(chr="III", start=30000, end=1064500,strand=("*"), score=1)) # chr3 left arm from tel to cen(no tel, no cen)
df<- rbind(df,data.frame(chr="III", start=1144800, end=2438000,strand=("*"), score=1)) # chr3 right arm from cnt to tel (no centr, no tel)
filt.GR<-makeGRangesFromDataFrame(df,seqinfo=seqinfo(ann.gr))
gr.filter<-overlapsAny(ann.gr,filt.GR, type="within")
sum(gr.filter)
save(gr.filter, file="sp07.mRNA.NoHetChr.filter")
setwd("~/Desktop/R/annotation/S.pombe.EF2/filters")
load("~/Desktop/R/annotation/S.pombe.EF2/EF2.introns1to854.Rdat")
df <- data.frame(chr="I", start=50000, end=739000,strand=("*"), score=1)  # chr1 left arm no telomer, until ura (no tel, no ura)
df<- rbind(df,data.frame(chr="I", start=746400, end=3752000,strand=("*"), score=1)) # chr1 left arm from ura to cen (no ura, no cen)
df<- rbind(df,data.frame(chr="I", start=3799000, end=5495200,strand=("*"), score=1)) # chr1 right arm from cen to tel (no cen, no tel)
df<- rbind(df,data.frame(chr="II", start=74000, end=1597500,strand=("*"), score=1)) # chr2 left arm no telomer, no centromer
df<- rbind(df,data.frame(chr="II", start=1650000, end=2113800,strand=("*"), score=1)) # chr2 right arm from cnt to mat locus (no centr, no mat locus)
df<- rbind(df,data.frame(chr="II", start=2138000, end=4484000,strand=("*"), score=1)) # chr2 right arm from mat to tel (no mat, no tel)
df<- rbind(df,data.frame(chr="III", start=30000, end=1064500,strand=("*"), score=1)) # chr3 left arm from tel to cen(no tel, no cen)
df<- rbind(df,data.frame(chr="III", start=1144800, end=2438000,strand=("*"), score=1)) # chr3 right arm from cnt to tel (no centr, no tel)
filt.GR<-makeGRangesFromDataFrame(df,seqinfo=seqinfo(ann.gr))
gr.filter<-overlapsAny(ann.gr,filt.GR, type="within")
ann.gr
sum(gr.filter)
save(gr.filter, file="EF2.introns1to854.NoHetChr.filter")
dir()
load("EF2.introns1to854.medianexpr.min20.filter")
sum(gr.filter)
gr.filter<-gr.filter&aaa
length(aaa)
length(gr.filter)
load("EF2.introns1to854.medianexpr.min20.filter")
length(gr.filter)
load("~/Desktop/R/annotation/S.pombe.EF2/EF2.introns1to854.Rdat")
length(gr.filter)
filt.GR
gr.filter<-overlapsAny(ann.gr,filt.GR, type="within")
length(gr.filter)
save(gr.filter, file="EF2.introns1to854.NoHetChr.filter")
aaa<- gr.filter
length(aaa)
load("EF2.introns1to854.medianexpr.min20.filter")
sum(gr.filter)
gr.filter<-gr.filter&aaa
sum(gr.filter)
save(gr.filter, file="EF2.introns1to854.medianexpr.min20.NoHetChr.filter")
